# 网络模型
> OSI模型
> - 应用层（application layer）  #http、https、ftp、telnet、ssh、smtp、pop3
> - 表示层（presentation layer）  #把数据转换为能与接收者的系统格式兼容并适合传输的格式
> - 会话层（session layer） #负责在数据传输中设置和维护计算机网络中两台计算机之间的通信连接
> - 传输层（transport layer） #把传输表头（TH）加至数据以形成数据包。传输表头包含了所使用的协议等发送信息。传输控制协议：tcp，udp
> - 网络层（network layer） #决定数据的路径选择和转寄，将网络表头（NH）加至数据包，以形成分组。网络表头包含了网络数据。互联网协议：ip
> - 链路层（data link layer）  #负责网络寻址、错误侦测和改错。当表头和表尾被加至数据包时，会形成帧。以太网（ethernet），无限局域网（WIFI）和通用分组无限服务（GPRS）
>   - 数据链表头（DLH）包含了物理地址和错误侦测以及改错的方法。
>   - 数据链表尾（DLT）是一串指示数据包末端的字符串。
> - 物理层 （physical layer）  #在局部局域网上传送数据帧（data frame），负责管理计算机通信设备和网络媒体之间的互通。包括了针脚，电压，线缆规范，集线器，中继器，网卡，主机适配器。

# showtime
> ```
>     cd /proc/$$/fd  #进去当前进程的文件描述符目录
>     exec 8<> /dev/tcp/www.baidu.com/80  #创建文件描述符8，并且输入输出指向磁盘目录
>     ll  #可见8文件描述符指向socket，可知已经过三次握手建立连接
>     echo -e 'GET / HTTP/1.0\n' >& 8  #将'GET / HTTP/1.0输出到文件描述符8，其中字符串是http协议中规定的最小请求头
>     cat 0<& 8  #输出文件描述符8的内容，执行可见获取了百度页面内容
> ```
> 1. 建立连接
> 2. 传输数据（http协议：规范标准）
> 
> - 应用层 （用户态）
>   - 数据格式化
> - 传输层 （内核态）
>   - netstat -natp（传输层表）
>   - 创建数据包
> - 网络层 （内核态）
>   - route -n（网络层表）
> - 链路层 （内核态）
>   - arp -a（链路层表）
> - 物理层 （内核态）

# 传输层：tcp，udp
> ## TCP 
> - 一种面向连接的、可靠的、基于字节流的传输层通信协议
> - 三次握手 -> 数据传输 -> 四次分手
>   - 最小粒度，不可分割：假想：一个client，多个server负载均衡，第一次握手打在server1，第三次握手却打在server2，大问题！！
> - 连接断开并不是物理上断开了，连接断开本质上是资源的释放
>   - 如何建立连接 => 三次握手
>       - 为何是三次：本质上双方确认是否【能够】通信（输入输出）成功
>           1. 发送方发送，接收方接收：
>           2. 接收方发送，发送方接收：发送方输入成功，发送方输出成功
>           3. 发送方发送，接收方接收：接收方输入成功，接收方输出成功
>       - 三次握手完成后，双方才通知应用层占用资源，开启线程
>   - 如何断开连接 => 四次分手
>       - 为何需要四次分手
>           1. 资源有限，不能无限增长资源
>           2. 连接断开，需要双方确认，以确保数据已经传输完毕
>       - 为何是四次：本质上双方确认是【同意】断开通信
>           1. 发送方发送，接收方接收：
>           2. 接收方发送，发送方接收：发送方断开信息发送成功（发送方知道对方已收到要断开的通知）
>           3. 接收方发送，发送方接收：发送方确认可以断开连接（发送方知道对方同意断开连接）
>           4. 发送方发送，接收方接收：接收方确认可以断开连接（接收方知道对方同意断开连接）
>   - 如何确认可靠
>       - 三次握手和四次分手
>       - 数据发送后，会收到确认
>   - 偷懒的tcp（tcp的优化，可能导致三次握手和数据传输界限不明确）
>       - 在第三次握手的时候，会带着数据一并发送
>       - 在数据传输的时候，确认包会带着数据一并发送（就是不断地确认，确认，确认...）

# 网络层：IP协议
> ```
>   cat /etc/sysconfig/network-scripts/ifconfig-XXX
>       TYPE=Ethernet  #以太网
>       IPADDR  #IP地址
>       NETMASK  #子网掩码，与IPADDR作位与运算，得到网络号
>       GATEWAY  #网关
>       DNS  #domain name system，域名系统，域名解析，把域名转为ip
> ```
> - 网络层任务：找到目标地址，方案：
>   1. 所有机器自己记录所有地址的数据，数据海量，速度过慢
>   2. IP协议：下一跳机制：只记录某个范围内数据 => 通过路由找到下一个范围内数据。。。（被抨击，存在丢包问题，可经过试验没问题）
> - TCP/IP协议  
>   ```ping www.baidu.com```
>   1. 通过DNS获取目标IP
>   2. 通过目标IP，与Genmask（子网掩码）作位与运算，再与Destination匹配，获得最终Gateway
>   ![alt 路由表](src/picture/route.jpeg)
>       - 当匹配到Gateway为0.0.0.0时，可以直接跟目标地址通信。当匹配到的Gateway非0.0.0.0时，需要跳到下个路由。
>       - Genmask为0.0.0.0的是默认网关，一般是路由器地址

# 链路层：ARP协议
> 

